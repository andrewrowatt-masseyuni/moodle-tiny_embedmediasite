define("tiny_embedmediasite/ui",["exports","./modal","core/templates","core/notification","./repository"],(function(_exports,_modal,_templates,_notification,_repository){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * TODO describe module ui
   *
   * @module     tiny_embedmediasite/ui
   * @copyright  2026 Andrew Rowatt <A.J.Rowatt@massey.ac.nz>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.handleAction=void 0,_modal=_interopRequireDefault(_modal),_templates=_interopRequireDefault(_templates);_exports.handleAction=async editor=>{displayDialogue(editor)};const displayDialogue=async editor=>{let page=1,presentations=await(0,_repository.getMyMediasitePresentations)(page).catch((error=>(0,_notification.exception)(error)));const modal=await _modal.default.create({templateContext:presentations,large:!0,removeOnClose:!0});await modal.show();const contentContainer=document.getElementById("tiny_embedmediasite_content-container");contentContainer.addEventListener("click",(async event=>{const target=event.target;if(target&&target.classList.contains("tiny-embedmediasite-insert-button")){const{html:html}=await _templates.default.renderForPromise("tiny_embedmediasite/_embedlink",{source:target.dataset.source,title:target.dataset.title});editor.insertContent(html),modal.destroy()}}));const loadingIndicator=document.getElementById("tiny_embedmediasite_loading"),noMoreContentIndicator=document.getElementById("tiny_embedmediasite_no_more_content");document.getElementById("tiny_embedmediasite_refresh_thumbnails").addEventListener("click",(()=>{contentContainer.querySelectorAll("img").forEach((img=>{const src=img.src;img.src="",img.src=src}))}));const observer=new IntersectionObserver((async entries=>{entries[0].isIntersecting&&(observer.unobserve(loadingIndicator),page++,await async function(pageNumber){var _presentations$list;const presentations=await(0,_repository.getMyMediasitePresentations)(pageNumber).catch((error=>(0,_notification.exception)(error)));if(null===(_presentations$list=presentations.list)||void 0===_presentations$list||!_presentations$list.length)return 0;const{html:html,js:js}=await _templates.default.renderForPromise("tiny_embedmediasite/_presentations",presentations);return _templates.default.appendNodeContents("#tiny_embedmediasite_content-container",html,js),presentations.list.length}(page)?observer.observe(loadingIndicator):(loadingIndicator.style.display="none",noMoreContentIndicator.style.display="block"))}),{root:null,threshold:1,rootMargin:"0px"});observer.observe(loadingIndicator)}}));

//# sourceMappingURL=ui.min.js.map